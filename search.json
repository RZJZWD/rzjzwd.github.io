[{"title":"嵌入式驱动开发 记录驱动ST7735过程","url":"/2025/01/25/development%20of%20the%20st7735%20driver/","content":"前言寒假回家没事做，特意带了一块1.8寸的TFT屏来练习驱动开发，驱动为ST7735，主控为是RCT6。用了三天加上查阅网上资料，算是磕磕绊绊的把驱动写完了。把开发过程中的过程和问题记录一下，做个备忘。\nST7735介绍ST7735的介绍网上非常多，我就不再重复了。对于ST7735，屏幕的显示原理不是我们应该深究的地方。只谈应用，我个人觉得其内部的RAM（姑且这么称呼）很有意思，还有写入指令一定要仔细，以及ST7735的是在上升沿读入指令数据，这点非常重要，后文会提到。\n硬件spi驱动驱动ST7735的过程也是学习配置spi的过程，所以我选择使用硬件spi。驱动屏幕不需要读数据，用不到MISO线。\n引脚定义\n\n\nGPIO\nST7735\n说明\n\n\n\nPA7\nSDA\n数据写入\n\n\nPA5\nSCL\n时钟\n\n\nPA4\nCS\n片选\n\n\nPC4\nRESET\n硬件复位\n\n\nPC5\nDC\n数据命令选择\n\n\nBLK引脚接高即可\n初始化代码spiSPI_InitStr.SPI_BaudRatePrescaler   = SPI_BaudRatePrescaler_2;// 使分频值达到最大SPI_InitStr.SPI_CPHA\t\t\t    = SPI_CPHA_2Edge;\t\t  // 上升沿有效SPI_InitStr.SPI_CPOL\t\t\t\t= SPI_CPOL_High;\t\t  // 低电平有效,空闲时为高SPI_InitStr.SPI_CRCPolynomial\t    = 7;\t\t\t\t\t  // 无 CRC 校验SPI_InitStr.SPI_DataSize\t\t\t= SPI_DataSize_8b;\t\t  // 发送字长为 8 位SPI_InitStr.SPI_Direction\t\t    = SPI_Direction_1Line_Tx; // 方向为发送SPI_InitStr.SPI_FirstBit\t\t\t= SPI_FirstBit_MSB;\t\t  // 高位先行SPI_InitStr.SPI_Mode\t\t\t\t= SPI_Mode_Master;\t\t  // 主机模式SPI_InitStr.SPI_NSS\t\t\t\t    = SPI_NSS_Soft;\t\t\t  // 软件控制\nCPHA控制在那个边沿发送CPOL控制spi空闲时的状态\n\nST7735要求上升沿接收，如下图。CPOL设置空闲时为高，当要传数据时MOSI拉低再拉高完成一位数据传输，上升沿为第二个边沿，也就是CPHA设置为2edge。\n\n（ST7735数据手册104页）spi写数据函数：\nvoid SPI1_WriteData(uint8_t data)&#123;\tuint16_t timeout=0;\twhile(SPI_I2S_GetFlagStatus(SPI1,SPI_I2S_FLAG_TXE) == RESET)&#123;\t//发送缓冲区为空时（TXE=1）才可以写入\t\tif(++timeout &gt; 200)\t\t\t\t\t\t\t\t\t\t//超时200直接退出\t\t\treturn;\t&#125;\tSPI_I2S_SendData(SPI1,data);&#125;\n\nST7735初始化网上初始化命令的教程有很多，直接照抄即可，下为我的配置：\nvoid TFT_ST7735_Config(void)&#123;\tTFT_ST7735_Reset();\tTFT_ST7735_Write(TFT_DC_CMD,TFT_SLPOUT);\tdelay_ms(120);\t\tTFT_ST7735_Write(TFT_DC_CMD, TFT_FRMCTR1);\tTFT_ST7735_Write(TFT_DC_DATA, 0x05);\tTFT_ST7735_Write(TFT_DC_DATA, 0x3C);\tTFT_ST7735_Write(TFT_DC_DATA, 0x3C);\t\tTFT_ST7735_Write(TFT_DC_CMD, TFT_FRMCTR2);\tTFT_ST7735_Write(TFT_DC_DATA, 0x05);\tTFT_ST7735_Write(TFT_DC_DATA, 0x3C);\tTFT_ST7735_Write(TFT_DC_DATA, 0x3C);\t\tTFT_ST7735_Write(TFT_DC_CMD, TFT_FRMCTR3);\tTFT_ST7735_Write(TFT_DC_DATA, 0x05);\tTFT_ST7735_Write(TFT_DC_DATA, 0x3C);\tTFT_ST7735_Write(TFT_DC_DATA, 0x3C);\tTFT_ST7735_Write(TFT_DC_DATA, 0x05);\tTFT_ST7735_Write(TFT_DC_DATA, 0x3C);\tTFT_ST7735_Write(TFT_DC_DATA, 0x3C);\t\t//===============inversion of control=============\tTFT_ST7735_Write(TFT_DC_CMD, TFT_INVCRT);\tTFT_ST7735_Write(TFT_DC_DATA, 0x03);\t//===============power set========================\tTFT_ST7735_Write(TFT_DC_CMD, TFT_PWCTR1);\tTFT_ST7735_Write(TFT_DC_DATA, 0x28);\tTFT_ST7735_Write(TFT_DC_DATA, 0x08);\tTFT_ST7735_Write(TFT_DC_DATA, 0x04);\t\t\tTFT_ST7735_Write(TFT_DC_CMD, TFT_PWCTR2);\tTFT_ST7735_Write(TFT_DC_DATA, 0xC0);\tTFT_ST7735_Write(TFT_DC_CMD, TFT_PWCTR3);\tTFT_ST7735_Write(TFT_DC_DATA, 0x0D);\tTFT_ST7735_Write(TFT_DC_DATA, 0x00);\t\tTFT_ST7735_Write(TFT_DC_CMD, TFT_PWCTR4);\tTFT_ST7735_Write(TFT_DC_DATA, 0x8D);\tTFT_ST7735_Write(TFT_DC_DATA, 0x2A);\t\tTFT_ST7735_Write(TFT_DC_CMD, TFT_PWCTR5);\tTFT_ST7735_Write(TFT_DC_DATA, 0x8D);\tTFT_ST7735_Write(TFT_DC_DATA, 0xEE);\t//===============vcom set=========================\tTFT_ST7735_Write(TFT_DC_CMD, TFT_VMCTR1);\tTFT_ST7735_Write(TFT_DC_DATA, 0x1A);\t\t//===============scanning direction set===========\t\tif(TFT_DIRECTION==0)\t\tTFT_ST7735_SetScanDirection(0x00);//显示方向选择\telse if(TFT_DIRECTION==1)\tTFT_ST7735_SetScanDirection(0xC0);\telse if(TFT_DIRECTION==2)\tTFT_ST7735_SetScanDirection(0xA0);\telse\t\t\t\t\t\tTFT_ST7735_SetScanDirection(0x70);\t\t//===============gamma sequence set===============\tTFT_ST7735_Write(TFT_DC_CMD, TFT_GMCTRP1);\tTFT_ST7735_Write(TFT_DC_DATA, 0x04);\tTFT_ST7735_Write(TFT_DC_DATA, 0x22);\tTFT_ST7735_Write(TFT_DC_DATA, 0x07);\tTFT_ST7735_Write(TFT_DC_DATA, 0x0A);\tTFT_ST7735_Write(TFT_DC_DATA, 0x2E);\tTFT_ST7735_Write(TFT_DC_DATA, 0x30);\tTFT_ST7735_Write(TFT_DC_DATA, 0x25);\tTFT_ST7735_Write(TFT_DC_DATA, 0x2A);\tTFT_ST7735_Write(TFT_DC_DATA, 0x28);\tTFT_ST7735_Write(TFT_DC_DATA, 0x26);\tTFT_ST7735_Write(TFT_DC_DATA, 0x2E);\tTFT_ST7735_Write(TFT_DC_DATA, 0x3A);\tTFT_ST7735_Write(TFT_DC_DATA, 0x00);\tTFT_ST7735_Write(TFT_DC_DATA, 0x01);\tTFT_ST7735_Write(TFT_DC_DATA, 0x03);\tTFT_ST7735_Write(TFT_DC_DATA, 0x13);\tTFT_ST7735_Write(TFT_DC_CMD, TFT_GMCTRN1);\tTFT_ST7735_Write(TFT_DC_DATA, 0x04);\tTFT_ST7735_Write(TFT_DC_DATA, 0x16);\tTFT_ST7735_Write(TFT_DC_DATA, 0x06);\tTFT_ST7735_Write(TFT_DC_DATA, 0x0D);\tTFT_ST7735_Write(TFT_DC_DATA, 0x2D);\tTFT_ST7735_Write(TFT_DC_DATA, 0x26);\tTFT_ST7735_Write(TFT_DC_DATA, 0x23);\tTFT_ST7735_Write(TFT_DC_DATA, 0x27);\tTFT_ST7735_Write(TFT_DC_DATA, 0x27);\tTFT_ST7735_Write(TFT_DC_DATA, 0x25);\tTFT_ST7735_Write(TFT_DC_DATA, 0x2D);\tTFT_ST7735_Write(TFT_DC_DATA, 0x3B);\tTFT_ST7735_Write(TFT_DC_DATA, 0x00);\tTFT_ST7735_Write(TFT_DC_DATA, 0x01);\tTFT_ST7735_Write(TFT_DC_DATA, 0x04);\tTFT_ST7735_Write(TFT_DC_DATA, 0x13);\t//===============color format set=================\tTFT_ST7735_SetColorFormat(0x05);\t//===============display on=======================\tTFT_ST7735_Write(TFT_DC_CMD, TFT_DISPON);&#125;\n踩坑记录网上初始化命令的教程有很多，我主要说一下我在初始化中有过疑惑的几个点\n\n0x36hMADCTL命令（ST7735数据手册142页）spi数据高位先行，RGB位设置为0选择以 “RGB” 的顺序读入颜色数据\n\n初始化成功后花屏ST7735的frame memory（显存）上电后为随机值，故初始化后花屏，全屏填充白色就可以了ST7735数据手册89页）\n\n\n","tags":["驱动","STM32","笔记"]},{"title":"大学生想兼职赚钱就别指望还能学技术","url":"/2025/05/25/%E5%A4%A7%E5%AD%A6%E7%94%9F%E6%83%B3%E5%85%BC%E8%81%8C%E8%B5%9A%E9%92%B1%E5%B0%B1%E5%88%AB%E6%8C%87%E6%9C%9B%E8%BF%98%E8%83%BD%E5%AD%A6%E6%8A%80%E6%9C%AF/","content":"前言在5月21日，我正式结束了我在少儿编程培训班（以下简称机构）的兼职合计三次交作品——350+650+150&#x3D;1150，一共七个，历时三个月，记一下这次的经历。先说结论：大学生如果是为了赚钱就直接去赚钱最多的兼职，比如家教之类的，别想着去干自己专业相关的兼职还能赚钱，你的时间很宝贵，而且实际情况大概率不是你想的那样。\n第一次接触2月21日从群里看到有个机构需要人，负责制作嵌入式小作品和可能的授课，看到这个消息的我很开心，因为这个兼职和我的专业很契合，于是兴冲冲的联系学长。交了一个小简历，25号给了我机构负责人老师的微信（以下简称h老师）  \n2月25日加上微信，确认了面试时间在2月28日\n2月28日我去的前一天（2.27）没有再和h老师确认，于是被放鸽子了不过h老师说机构有别的老师在，让我上去还是去搞了一次不伦不类的“面试”。最后只确认了上班的时间和我主要的工作，给小学生做科创比赛作品。但其实后面就是有时间要做东西才去。\n\n一开始去早了，还和楼下保安聊了一会，最后会提到\n\n3月3日晚上和h老师在微信上确认了要干啥，用Arduino，这个h老师非常在意 “开源”，他给我一些关于比赛的资料和做的项目都是他说的 “开源”。后面会回收伏笔还有做项目需要的硬件我先自己买，后面他在补给我\n\ns所谓开源，点进去一看，有想法，代码——只有截图，图纸——只要图片，什么源文件都没有，然后 “开源”\n\n正式开工正式开工前正式和h老师见了一面，人很不错，说话也客气，没有因为我是学生就怎么样，这也是我虽然吐槽但是还是认真干我该干的活的原因之一确认下来一个项目起价150，根据难度上调价格。  \n3月11日开始做，去了机构，说是给我分配电脑（这个我一开始就问过他了，他给我说东西都有），其实就是机构授课的老师的笔记本，谁不在就把谁的给我，而且问的时候哪里的老师也不清楚具体情况。总的来说，我就是独立出来干活，和他们没有交集非常古老的联想商务本，没有电池，卡的批爆。根本没法用，磨蹭了一下午我就走了，后面就是带自己的电脑\n3月19日做完了两个，h老师来看完要给我结钱，因为是第一次搞，怎么要价我也不好开口，最后是两个一共350。七点钟从机构离开，我非常兴奋，因为是第一次赚到钱，脚步都是轻的。这段时间我每天下午三点到，六点多快七点走。\n\n在这里做项目，题目都是自己想，除了写程序，调硬件 还要负责制作外观，撰写文档 不过是给小学生做的，都比较简单，可是架不住它事多。我也是第一次学建模和3d打印\n\n中间还有段小插曲，h老师问我怎么使用3d打印机，其实我也是第一次接触啊，这种东西看看官方的使用文档不就知道了吗。于是晚上给我打视频让我教怎么用😶\n3月23日前面歇了几天之前提过，这里做东西题目要自己想，于是我到处查创客网站和科创比赛获奖名单想了三个毙了两个，因为是很常见的东西。h老师让我先做，于是我买了东西准备快递到了就去做，在等待的时候h老师告诉我：搜一下让生活更美好主题，找两个项目我:😓，我靠，这种宽泛的主题说了和没说有啥两样不过最后还是凑了俩上去，中间他和我说，做东西要往大做\n4月15日这三个做的差不多了，他告诉我再做一个停车场的，这次外观不是3d打印了，而是玻纤板切割组装，为了这个我又去学习开源的CAD软件libreCAD\n4月25日中间时间要组装前三个，还要调试第四个的硬软件，这天我才把图纸画出来，又正逢五一假期，等到切割的样板到，已经是5.5了\n5月5日我到机构一看样板（木板切割的）发现h老师把我的图层都合并在一起了，导致大部分地方都切错了，我也没说，大概组装了一下发现没大问题，再把小问题修改了一下。后面我问他使用玻纤板切割的话公差要留多少合适，答案是没有\n\n四月中旬的时候我说我暑假要去实习，h老师说本来是想让我暑假把我做的项目教给小朋友，然后再开一个使用3d打印机的课程。我表示暑假应该不留，他说到时候再说吧\n\n5月7日h老师问我五月是不是再做一些，我答应了，后面看来其实非常不应该，做完手头的就应该直接告辞，后面就是折磨。然后我又想了一个，还是买东西等快递\n\n这中间发生了很搞笑的事，我说了一个双人对战口算机的想法，他先是说这个年年有人做，当我说这个我搜了没见过和类似的东西后，他又改口：确实不常见，然后问我是不是 “开源” 的。我是这个是我自己想的，而且之前做的也都是只有想法，没有源码和外壳文件只能自己做。他回我——“👍，人才”\n\n5月13日玻纤板终于回来了，我装了两个下午，主要是我没加公差，比如一个插件那种就要留一点余量。然后和他说了后面的安排，明确了我五月干完就要走。然后给我结了钱，前三个各150，第四个200。结完钱和我说下次来做个小车，具体当面和我说\n5月19日和h老师见了一面，我表示如果小车太难搞我可能没时间做了，他表示理解然后晚上给我发了一个链接我当时看完都傻眼了，告诉他我做不了\n5月20日最后一个也做完了。把源码，外壳模型文件，手册啥的都整理好了。验收了一下，给我结完最后一个150，我就走了。走的时候还和楼下保安聊了几句，总结就是这里挣不到什么钱还浪费时间\n回顾与总结历时差不多三个月，我去每次去机构都是公交通勤，路上要倒车，来回一次4块。两点多从学校走，三点到机构，一般都是做到六点多才走，等回学校时都七八点了，有几次搞忘时间，等回学校已经九点了。在那里不能说啥也没学到，为了做东西还是自学了一点技能，不过和我浪费掉的时间比真不算什么。为了做机构的项目，有时候闲着还想想题目，还是有点折磨的。五月中我还准备暑假实习，其实已经有点晚了，而且我也没有自己的项目，简历上空空荡荡的哈哈哈，如果你要准备实习的话还是不要浪费时间，做一些能展现水平的东西，给小学生做的小东西没啥用。\n最后，钱也没挣到，时间浪费许多，虽然有一点收获，但总体是亏的\n文章标题其实是暴论，事实也可能没那么糟。\n","categories":["日常生活"],"tags":["日常生活","兼职","大学生","随想"]}]